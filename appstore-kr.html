<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>App Store KR Top 10 – Daily Ranking</title>
  <meta name="description" content="매일 자동 업데이트되는 한국 앱스토어 인기 앱 Top 10." />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Custom styles for glass effect */
    .glass-card {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-blue-50 to-pink-50 text-slate-800">
  <header class="py-6">
    <div class="mx-auto max-w-4xl px-4 flex items-center justify-between">
      <h1 class="text-3xl sm:text-4xl font-bold tracking-tight drop-shadow-sm">App Store KR Top 10</h1>
      <div id="updatedAt" class="text-sm text-slate-600">로딩 중…</div>
    </div>
  </header>

  <main class="mx-auto max-w-4xl px-4 py-2">
    <p class="text-slate-600 mb-4">
      공식 iTunes RSS 피드를 기반으로 매일 오전 8시(KST) 자동 갱신됩니다.
    </p>
    <ol id="list" class="space-y-4"></ol>
    <!-- 광고 자리 (예: Google AdSense) -->
    <div class="mt-6 flex justify-center">
      <div class="glass-card rounded-2xl p-6 w-full text-center text-sm text-slate-500">
        광고 영역입니다.
      </div>
    </div>
  </main>

  <footer class="mx-auto max-w-4xl px-6 py-4 text-center text-xs text-slate-500">
    © <span id="year"></span> Daily Rankings. All rights reserved.
  </footer>

  <script>
    const listEl = document.getElementById('list');
    const updatedAtEl = document.getElementById('updatedAt');
    document.getElementById('year').textContent = new Date().getFullYear();

    async function load() {
      try {
        const res = await fetch('./data/appstore-kr.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('Failed to load JSON');
        const data = await res.json();
        render(data);
      } catch (e) {
        console.error(e);
        // fallback demo data when JSON is missing or invalid
        render({
          updatedAt: new Date().toISOString(),
          items: [
            { rank: 1, title: '데모 앱 1', artist: '회사 A', category: '게임', url: '#', icon: '', price: '무료' },
            { rank: 2, title: '데모 앱 2', artist: '회사 B', category: '생산성', url: '#', icon: '', price: '₩1,000' },
            { rank: 3, title: '데모 앱 3', artist: '회사 C', category: '유틸리티', url: '#', icon: '', price: '무료' }
          ]
        });
      }
    }

    function render({ updatedAt, items }) {
      updatedAtEl.textContent = `업데이트: ${new Date(updatedAt).toLocaleString('ko-KR')}`;
      listEl.innerHTML = '';
      items.slice(0, 10).forEach(it => {
        const li = document.createElement('li');
        li.className = 'glass-card rounded-2xl shadow-lg flex items-center gap-4 p-4';
        li.innerHTML = `
          <div class="w-8 sm:w-10 text-lg sm:text-xl font-extrabold text-purple-600 tabular-nums">${it.rank}</div>
          <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-xl overflow-hidden bg-slate-100 flex-shrink-0">
            ${it.icon ? `<img src="${it.icon}" alt="${it.title}" class="w-full h-full object-cover" />` : ''}
          </div>
          <div class="flex-1 min-w-0">
            <a href="${it.url || '#'}" target="_blank" rel="noreferrer noopener" class="text-base sm:text-lg font-medium hover:underline block truncate">${it.title}</a>
            <div class="text-sm text-slate-600 truncate">${it.artist ?? ''}${it.category ? ' · ' + it.category : ''}</div>
            <div class="text-xs text-slate-500">${it.price ?? '무료'}</div>
          </div>
        `;
        listEl.appendChild(li);
      });
    }

    load();
  </script>
</body>
</html>
